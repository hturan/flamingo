<!DOCTYPE html>
<html>
<head>
  <title>flamingo</title>

  <style type="text/css">
    html, body {
      height: 100%;
      width: 100%;
      position: relative;
      margin: 0;
      padding: 0;
      background: black;
    }
  </style>
</head>
<body>
  <script type="text/javascript">
    var ws = new WebSocket(location.origin.replace(/^http/, 'ws'));

    var webSocketActive = false;
    var deviceOrientation = {x: 0, y: 0, z: 0};

    ws.onopen = function () {
      ws.send(JSON.stringify({clientType: 'controller'}));
      webSocketActive = true;
    };

    // Update server position at 60fps
    setInterval(function () {
      if (webSocketActive) {
        ws.send(JSON.stringify(deviceOrientation));
      }
    }, (1000/60));

    window.addEventListener('deviceorientation', function(event) {
      deviceOrientation.x = event.beta;
      deviceOrientation.y = event.alpha;
      deviceOrientation.z = event.gamma;
    });
  </script>
</body>
</html>